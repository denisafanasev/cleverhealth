{% extends "base.html" %}
{% block main_block %}
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>
    <link rel="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css" type="text/css"/>
    <script src="{{ url_for('static' , filename="js/datatables.js") }}"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function () {

        var datatablesButtons = $("#datatables-buttons").DataTable({
            responsive: true,
            lengthChange: !1,
            {#displayStart: {{ _num_page * 10 }}#}

        });

        datatablesButtons.buttons().container().appendTo("#datatables-buttons_wrapper .col-md-6:eq(0)");

        $("#date_start").flatpickr("optional_config");
        $("#date_end").flatpickr("optional_config");

    })
    </script>

    <script>
    $(document).ready(function() {
            $('#students_list').multiselect({
                includeSelectAllOption: true,
                scrollY: true,
                maxHeight: 450,
            });
            $('#curators_list').multiselect({
                scrollY: true,
                maxHeight: 450,
                includeSelectAllOption: true
            });
        })
    </script>

    <div class="container-fluid p-0">

        <h1 class="h3 mb-3">{{_("Обучающие потоки")}}</h1>
        <div class="card border">
            <div class="card-body">
                <div id="datatables-buttons_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                    <div class="dt-buttons btn-group flex-wrap">
                        <a class="btn btn-secondary buttons-copy buttons-html5" aria-controls="datatables-buttons"
                        href="{{ url_for('multilingual.education_stream_card') }}">
                            <span>{{_("Добавить обучающий поток")}}</span>
                        </a>
                    </div>
                    <table id="datatables-buttons" class="table table-striped dataTable no-footer dtr-inline" style="width: 100%; font-size: 13px" aria-describedby="datatables-buttons_info">
                        <thead style="text-align: center">
                            <tr>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:30%; text-align: left;" aria-label="Position: activate to sort column ascending">
                                    {{_("Название")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:5%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Преподаватель")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:5%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Дата старта")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:5%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Дата окончания")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:15%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Обучающий курс")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:5%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Количество кураторов")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:5%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Количество обучающихся")}}
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="datatables-buttons" rowspan="1" colspan="1"
                                    style="width:10%; text-align: center;" aria-label="Position: activate to sort column ascending">
                                    {{_("Статус")}}
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for education_stream in _education_streams_list %}
                                {% if education_stream['id'] != 0 %}
                                    <tr class="even" >
                                        <td>
                                            <div style="text-align: left; margin-right: 21%">
                                                <a href="{{ url_for('multilingual.education_stream_card', id=education_stream['id']) }}">{{ education_stream['name'] }}</a>
                                            </div>
                                        </td>
                                        <td>
                                            <div style="text-align: left; margin-right: 14%">{{ education_stream['teacher'] }}</div>
                                        </td>
                                        <td>{{ education_stream['date_start'] }}</td>
                                        <td>{{ education_stream['date_end'] }}</td>
                                        <td>
                                            <div style="text-align: center">{{ education_stream['course']['name'] }}</div>
                                        </td>
                                        <td>
                                            <div style="text-align: center; margin-right: 21%">{{ education_stream['count_curators'] }}</div>
                                        </td>
                                        <td>
                                            <div style="text-align: center; margin-right: 15%">{{ education_stream['count_students'] }}</div>
                                        </td>
                                        <td>
                                            <div class='badge {% if education_stream['status'] == "идет" %} bg-success
                                            {% elif education_stream['status'] == "запланирован" %} bg-info
                                            {% elif education_stream['status'] == "закончен" %} bg-danger {% endif %} bg-gradient text-light' style="display: block;text-align: center; margin-right: 15%">
                                                {{ education_stream['status'] }}
                                            </div>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock %}